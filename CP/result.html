<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <title>亦知亦行-测评系统</title>
    <link rel="stylesheet" href="../assets/node_modules/normalize.css/normalize.css">
    <link rel="stylesheet" href="../assets/vendors/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="../assets/css/cp.main.css">
    <link rel="ICON" href="../assets/img/main/icon.png">
</head>
<body>
<!--<header>
    <div class="logo-box">
        <img src="../assets/img/logo.svg" alt="">
    </div>
</header>-->
<div class="cp-body" id="cp_result_page" v-cloak="">
    <div class="cp-content">
        <div class="cp-title-box ">
            <h3><img src="../assets/img/logo.svg" alt=""><span>知行测评</span></h3>
        </div>
        <div class="cp-result-content-box">
            <div class="cp-result-content">
                <h3><i class="fa fa-bookmark-o"></i>报告内容</h3>
                <p class="cp-result-content-1"><span>解读</span> - 在进行社会分配的时候，有三种类型：</p>
                <div class="cp-result-content-2 clear">
                    <p><span>社会型</span>这一类人关心别人，即使作出自我牺牲也愿意帮助别人；</p>
                    <p><span>自我型</span>这一类人只关心自己，并不介意别人比自己得到的多还是少；</p>
                    <p><span>竞争型</span>这一类人只关心自己和别人的差距，为了扩大差距愿意牺牲自己的利益。</p>
                </div>
                <p class="cp-result-content-3">详细了解“社交取向问卷”，请阅读「知行科学谈判」文章。</p>
                <p class="cp-result-content-4">您在每个类型上的得分分别为：</p>
                <div class="cp-result-content-5">
                    <p>社会型: <span></span><font>3</font></p>
                    <p>自我型: <span></span><font>3</font></p>
                    <p>竞争型: <span></span><font>3</font></p>
                </div>
                <p class="cp-result-content-5">如果您想要得到更详细的解答，需填写您的电子邮件、微信号和/或手机号码。</p>
                <div class="cp-result-content-6">
                    <p @click="showModal()">需要</p>
                    <p>不需要</p>
                </div>
            </div>
        </div>
    </div>
    <div class="cp-modal-box" id="cp_modal_box" v-show='isShowModal'>
        <div class="cp-container">
            <div class="cp-modal">
                <div class="cp-modal-title">
                    <span>请填写下面的信息</span>
                    <div class="cp-modal-close">
                        <a href="javascript:;" class="cp-close-btn" @click="closeModal()"></a>
                    </div>
                </div>
                <div class="cp-modal-content">
                    <div class="cp-form-box">
                        <div class="cp-input-box">
                            <label for="wechat">微信</label>
                            <input type="text" maxlength="20"  v-model='formData.wechat' class="cp-input" id="wechat" placeholder="请输入微信号">
                        </div>
                        <div class="cp-input-box">
                            <label for="email">邮箱</label>
                            <input type="text" v-model='formData.email' class="cp-input" id="email" placeholder="请输入邮箱地址">
                        </div>
                        <div class="cp-input-box cp-phone-input-box">
                            <label for="phone">电话<a href="javascript:;">+86</a></label><input type="text" maxlength="11" v-model='formData.phone' class="cp-input cp-phone-input" id="phone" placeholder="请填写手机号码">
                        </div>
                    </div>
                </div>
                <div class="cp-modal-footer">
                    <div class="cp-btn-box">
                        <a href="javascript:;" class="cp-btn cp-submit" @click="closeModal()">提交</a>
                        <a href="javascript:;" class="cp-btn cp-close" @click="closeModal()">取消</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript" src="https://res.wx.qq.com/open/js/jweixin-1.2.0.js"></script>
<script type="text/javascript" src="https://cdn.bootcss.com/echarts/4.0.4/echarts.min.js"></script>
<script type="text/javascript" src="https://cdn.bootcss.com/vue/2.5.17-beta.0/vue.min.js"></script>
<script type="text/javascript" src="https://cdn.bootcss.com/axios/0.18.0/axios.min.js"></script>
<script type="text/javascript">
    'user strict';
    var mainVue = new Vue({
        el: '#cp_result_page',
        data: {
            type:'',
            formData:{
                email:'',
                wechat: '',
                phone: ''
            },
            isShowModal: false,
            isOK: false
        },
        methods: {
            showModal: function () {
                this.isShowModal = true
            },
            closeModal: function () {
                this.isShowModal = false
            },
        },
        mounted: function () {
            function GetRequest() {
                var url = decodeURI(location.search);
                var theRequest = new Object();
                if (url.indexOf("?") != -1) {
                    var str = url.substr(1);
                    strs = str.split("&");
                    for(var i = 0; i < strs.length; i ++) {
                        theRequest[strs[i].split("=")[0]]=unescape(strs[i].split("=")[1]);
                    }
                }
                return theRequest;
            }
            var urlData = GetRequest();
            console.log(urlData);
            if(urlData.o === undefined || urlData.o === undefined ||urlData.length === 0){
                window.location.href = 'index.html';
            }else{
                var jsonStr = {
                    openid: ''
                };
                jsonStr.openid = urlData.o;
                this.o = urlData.o;
                console.log(this.o);
                axios.post('http://www.cogitoactio.com/api/v1/svo/user_analyse',{data:jsonStr})
                    .then(function (res) {
                        console.log(res.data);
                        var data = res.data;
                        if(data.status === 'Success'){
                            mainVue.type = data.user_style;
                            var myChart2 = echarts.init(document.getElementById('echarts_bar3'),
                                null, {renderer: 'svg'});
                            var option = {
                                tooltip: {
                                    show: true,
                                    formatter: "{a}<br>{b} : {c} ({d}%)"
                                },
                                legend: {
                                    x: 'center',
                                    itemGap: 15,
                                    itemWidth: 15,
                                    itemHeight: 15,
                                    textStyle: {
                                        color: '#797979',
                                        fontSize: 14,
                                        fontFamily: ['幼圆', 'PingFang SC Thin', 'Microsoft YaHei UI', 'sans-serif']
                                    },
                                    data: ['社会型', '自我型', '竞争型']
                                },
                                color:['#93D1F3', '#FA845A','#FFBD3D'],
                                calculable: true,
                                series: [
                                    {
                                        name: '测评数据',
                                        type: 'pie',
                                        radius: '75%',
                                        label: {
                                            normal: {
                                                position: 'inner'
                                            }
                                        },
                                        labelLine: {
                                            normal: {
                                                show: false
                                            }
                                        },
                                        data: data.result
                                    }]
                            };
                            myChart2.setOption(option);
                        }})
                    .catch(function (error) {
                        console.log(error);
                    })
            }
        }
    });
    // window.onload = function (ev) {
    //     var returnData = [];
    //     function GetRequest() {
    //         var url = decodeURI(location.search);
    //         var theRequest = new Object();
    //         if (url.indexOf("?") != -1) {
    //             var str = url.substr(1);
    //             strs = str.split("&");
    //             for(var i = 0; i < strs.length; i ++) {
    //                 theRequest[strs[i].split("=")[0]]=unescape(strs[i].split("=")[1]);
    //             }
    //         }
    //         return theRequest;
    //     }
    //     var urlData = GetRequest();
    //     console.log(urlData);
    //     if(urlData.o === undefined || urlData.o === undefined ||urlData.length === 0){
    //         window.location.href = 'index.html';
    //     }else{
    //         var jsonStr = {
    //             openid: ''
    //         };
    //         jsonStr.openid = urlData.o;
    //         axios.post('http://www.cogitoactio.com/api/v1/svo/user_analyse',{data:jsonStr})
    //             .then(function (res) {
    //                 var data = res.data;
    //                 if(data.status === 'Success'){
    //                     var myChart2 = echarts.init(document.getElementById('echarts_bar3'),
    //                         null, {renderer: 'svg'});
    //                     var option = {
    //                         tooltip: {
    //                             show: true,
    //                             formatter: "{a}<br>{b} : {c} ({d}%)"
    //                         },
    //                         legend: {
    //                             x: 'center',
    //                             itemGap: 15,
    //                             itemWidth: 15,
    //                             itemHeight: 15,
    //                             textStyle: {
    //                                 color: '#797979',
    //                                 fontSize: 14,
    //                                 fontFamily: ['幼圆', 'PingFang SC Thin', 'Microsoft YaHei UI', 'sans-serif']
    //                             },
    //                             data: ['Prosocial', 'Individualistic', 'Competitive']
    //                         },
    //                         color:['#93D1F3', '#FA845A','#FFBD3D'],
    //                         calculable: true,
    //                         series: [
    //                             {
    //                                 name: '测评数据',
    //                                 type: 'pie',
    //                                 radius: '75%',
    //                                 label: {
    //                                     normal: {
    //                                         position: 'inner'
    //                                     }
    //                                 },
    //                                 labelLine: {
    //                                     normal: {
    //                                         show: false
    //                                     }
    //                                 },
    //                                 data: [{
    //                                     value: 150,
    //                                     name: 'Prosocial'
    //                                 }, {
    //                                     value: 190,
    //                                     name: 'Individualistic'
    //                                 }, {
    //                                     value: 520,
    //                                     name: 'Competitive'
    //                                 }]
    //                             }]
    //                     };
    //                     myChart2.setOption(option);
    //                 }
    //             })
    //             .catch(function (error) {
    //                 return error
    //             })
    //     }
    //
    // }
</script>
</body>
</html>